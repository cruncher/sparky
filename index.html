<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="author" content="" />
	<meta name="description" content="" />
	
	<title>Sparky</title>
	
	<script>document.documentElement.className = 'js';</script>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
	<!-- Force latest IE rendering engine & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<!-- Make IE recognise HTML5 elements for styling -->
	<!--[if lte IE 8]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<noscript>
		<strong>Warning!</strong>
		Your browser does not support HTML5 so some elements on this page are simulated using JScript. Unfortunately your browser has JScript disabled. Please enable it in order to display this page.
	</noscript>
	<![endif]-->

	<link rel="icon" type="image/png" href="images/favicon.png" />
	<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
	
	<link rel="stylesheet" href="css/bolt.normalise.css" />
	<link rel="stylesheet" href="css/bolt.typography.css" />
	<link rel="stylesheet" href="css/bolt.typography.15_24.css" />
	<link rel="stylesheet" href="css/bolt.forms.css" />
	<link rel="stylesheet" href="css/bolt.classes.css" />

	<link rel="stylesheet" href="css/sparky.css" />
</head>

<body>

<div class="site-wrap wrap">
	<h1>Sparky</h1>
	
	<h3>
		<strong>Sparky is a model-agnostic live data binding view layer for your html5 app.</strong>
		Sparky enhances the existing DOM with declarative data bindings,
		passes data properties through Django-style template filters
		and renders multiple changes in batches on browser frames.
		
		It's fast and light-weight, weighing in at under 10K compressed.
	</h3>
	
	<h2>Try it.</h2>
	
	<p>Open the console and try changing the properties of <code>data</code>, like, say:</p>
	
	<ul>
		<li><code>data.name = 'Sparky'</code>
		<li><code>data.date = new Date()</code>
		<li><code>data.list = ['Sparky', 'loves', 'you']</code>
		<li><code>data.state = 1</code>
		<li><code>data.number = 4</code>
	</ul>
	
	<p>Changes cause this unrendered template to update...</p>

	<div class="sparky-block state-{{ state }}" data-data="data" id="template1">
		<p>Hello {{ name }}.</p>
		<p>It's {{ date | date: 'H:i' }} on the {{ date | date: 'dS F'}}.</p>
		<p>{{ list | join: '...' }}</p>
		<p>Here's a random pick from that list: {{ list | random }}</p>
		<p>Change attributes of inputs:</p>
		<input value="{{ value }}" />
		<table>
			<tr>
				<td>{{ number }}</td>
				<td>{{ number | add:1 }}</td>
			</tr>
			<tr>
				<td>{{ number | multiply: 2 }}</td>
				<td>{{ number | multiply: 2 | add: 1 }}</td>
			</tr>
			<tr>
				<td>{{ number | multiply: 4 }}</td>
				<td>{{ number | multiply: 4 | add: 1 }}</td>
			</tr>
			<tr>
				<td>{{ number | multiply: 8 }}</td>
				<td>{{ number | multiply: 8 | add: 1 }}</td>
			</tr>
		</table>
	</div>
	
	<p>All that was done by adding the attribute <code>data-data="data"</code></p>
	
	<h2>But I don't want to render directly from my data model.</h2>
	
	<p>
		Sparky allows you to define a view function.
		If that function returns an object then that object is used as the rendering context instead of the data object.
		Here's a view function for a clock that updates every second.
	</p>
	
	<pre>
sparky.views.clock = function(node, data) {
    var context = {};
    
    function update() {
        context.time = new Date()
    }
    
    setInterval(update, 1000);
    update();
    
    // Use the context object as the rendering context.
    return context;
}
	</pre>

	<p>Add the attribute <code>data-view="clock"</code> to the template and Sparky calls this view.</p>

	<div class="sparky-block block" data-view="clock" data-data="data" id="template2">
		<p>{{ time | date: 'H:i.s' }}</p>
	</div>

	<p>
		That view function is passed the node and the data object.
		The <code>data</code> object is found at the path in the <code>data-data="path.to.data"</code> attribute.
		This is where you put your data 'model': <code>sparky.data.path.to.data = {};</code>
		If <code>data-data=""</code> is an emtpy string, the root data object, <code>sparky.data</code>, is returned.
		If nothing is found, or where there is no <code>data-data</code> attribute, the data object is undefined.
	</p>
</div>


<script src="js/jquery-2.0.0b2.js"></script>
<script src="js/window.requestanimationframe.js"></script>
<!--script src="js/app.js"></script-->
<script src="js/observe.js"></script>

<script src="js/sparky.js"></script>
<script src="js/sparky.template.js"></script>
<script src="js/sparky.filters.js"></script>
<script>
	window.data = {
		name: '',
		date: new Date(),
		state: 4,
		list: ['one', 'two', 'three']
	};
	
	sparky.observe = observe;
	sparky.unobserve = unobserve;
	sparky.get = function(data, property) {
		return data[property];
	};
	
	sparky.data = {
		data: window.data
	};

sparky.views = {};
	
sparky.views.clock = function(node, data) {
	var context = {};
	
	function update() {
		context.time = 1;//new Date()
	}
	
	//setInterval(update, 1000);
	update();
	
	return context;
}
	
	sparky();
</script>


<table class="example-table" cellpadding="0" cellspacing="0">
	<thead>
		<tr>
			<th>JS</th>
			<th>HTML</th>
			<th class="html-td">Result</th>
			<th>Try</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>
				<div class="template-block">
					<script class="visible">
(function(sparky) {
    sparky.data.weather = {};

    sparky.views['weather-block'] = function(node, data, destroy) {
    	var elem = jQuery(node);
    	
    	elem.on('click', '.close-button', destroy);
    };
})(sparky);
					</script>
				</div>
			</td>
			<td>
				<div class="template-block block">
					<pre>
<span style="color:#cc6666;">&lt;div </span><span style="color:#de935f;">class</span><span style="color:#cc6666;">=</span><span style="color:#b5bd68;">&quot;weather-block block&quot;</span><span style="color:#cc6666;"> </span><span style="color:#de935f;">data-view</span><span style="color:#cc6666;">=</span><span style="color:#b5bd68;">&quot;weather-block&quot;</span><span style="color:#cc6666;"> </span><span style="color:#de935f;">data-data</span><span style="color:#cc6666;">=</span><span style="color:#b5bd68;">&quot;weather&quot;</span><span style="color:#cc6666;"> </span><span style="color:#de935f;">data-template</span><span style="color:#cc6666;">=</span><span style="color:#b5bd68;">&quot;#example-template&quot;</span><span style="color:#cc6666;"> &gt;</span>
    <span style="color:#cc6666;">&lt;p&gt;</span>Loading...<span style="color:#cc6666;">&lt;/p&gt;</span>
<span style="color:#cc6666;">&lt;/div&gt;</span>

<span style="color:#cc6666;">&lt;template </span><span style="color:#de935f;">id</span><span style="color:#cc6666;">=</span><span style="color:#b5bd68;">&quot;example-template&quot;</span><span style="color:#cc6666;"> </span><span style="color:#de935f;">class</span><span style="color:#cc6666;">=</span><span style="color:#b5bd68;">&quot;n{{temp|parseint}}-degrees&quot;</span><span style="color:#cc6666;">&gt;</span>
    <span style="color:#cc6666;">&lt;p&gt;</span>It's the {{ date|date:'dS F' }} and it's {{ feel }} outside.<span style="color:#cc6666;">&lt;/p&gt;</span>
    <span style="color:#cc6666;">&lt;img </span><span style="color:#de935f;">src</span><span style="color:#cc6666;">=</span><span style="color:#b5bd68;">&quot;</span><span style="color:#636cff;">{{ url }}</span><span style="color:#b5bd68;">&quot;</span><span style="color:#cc6666;"> </span><span style="color:#de935f;">alt</span><span style="color:#cc6666;">=</span><span style="color:#b5bd68;">&quot;{{ description }}&quot;</span><span style="color:#cc6666;"> /&gt;</span>
    <span style="color:#cc6666;">&lt;button </span><span style="color:#de935f;">class</span><span style="color:#cc6666;">=</span><span style="color:#b5bd68;">&quot;close-button button&quot;</span><span style="color:#cc6666;">&gt;</span>Close<span style="color:#cc6666;">&lt;/button&gt;</span>
<span style="color:#cc6666;">&lt;/template&gt;</span>
					</pre>
				</div>
			</td>
			<td class="html-td">
				<div class="weather-block block" data-view="weather-block" data-data="weather" data-template="example-template" >
					<p>Loading...</p>
				</div>
				
				<template id="example-template" class="n{{temp|parseint}}-degrees">
					<p>It's the {{ date|date:'dS F' }} and it's {{ feel }} outside.</p>
					<img src="{{ url }}" alt="{{ description }}" />
					<button class="close-button button">Close</button>
				</template>
			</td>
			<td>
<button id="init-button">Initialize <code>sparky.data.weather</code></button>
<script>
	jQuery(document).ready(function() {
		jQuery('#init-button').on('click', function() {
			jQuery.extend(sparky.data.weather, {
				temp: 8,
				feel: 'cold',
				date: new Date(),
				url: 'images/guesswhere.jpg',
				description: 'Guess where at guess@cruncher.ch.'
			});
		});
	});
</script>
			</td>
		</tr>

	</tbody>
</table>
















<!--input value="{{value}}" data-app="input" data-context="input"/-->



</body>
</html>
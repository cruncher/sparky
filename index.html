<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="author" content="" />
	<meta name="description" content="" />

	<title>Sparky</title>

	<script>document.documentElement.className = 'js';</script>

	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
	<!-- Force latest IE rendering engine & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<!-- Make IE recognise HTML5 elements for styling -->
	<!--[if lte IE 8]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<noscript>
		<strong>Warning!</strong>
		Your browser does not support HTML5 so some elements on this page are simulated using JScript. Unfortunately your browser has JScript disabled. Please enable it in order to display this page.
	</noscript>
	<![endif]-->

	<link rel="icon" type="image/png" href="images/favicon.png" />
	<link rel="apple-touch-icon" href="/apple-touch-icon.png" />

	<link rel="stylesheet" href="/bolt/package/css/bolt-0.9.8.css" />

	<style>
		html {
			background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0) 20rem, #EFEEEA 25rem, #FFF 100%), radial-gradient(#354767 22%, rgba(255,255,255,0) 70%), radial-gradient(#4A311E 22%, rgba(255,255,255,0) 70%), radial-gradient(#462129 22%, rgba(255,255,255,0) 70%), linear-gradient(to bottom, #3E242A 0, #313C4E 20rem, rgba(0, 0, 0, 0) 20rem);
			background-size: 100% 100%, 100% 40rem, 100% 40rem, 100% 43rem, 100% 100%;
			background-position: 0 0, 0 7rem,-55vw 5rem,63vw 1rem, 0 0;
			background-repeat: no-repeat;
			background-color: #3E242A;
		}

		body {
			margin: 0;
			padding: 0;
			padding-bottom: 7.5rem;
			color: #5F333D;
		}

		body > .grid-block,
		.float-block > .grid-block,
		.inline-h1 > .grid-block {
			margin-left: 1.25rem;
			margin-right: 1.25rem;
			max-width: 60rem;
		}

		body > .grid-block + .grid-block {
			margin-top: 3.75rem;
		}

		@media screen and (min-width: 65em) {
			body > .grid-block,
			.float-block > .grid-block,
			.inline-h1 > .grid-block {
				margin-left: auto;
				margin-right: auto;
			}
		}

		label {
			display: block;
		}

		.checked {
			color: green;
			background-color: red;
		}

		.hello {
			color: white;
			background-color: black;
		}

		.lead-block {
			display: inline-block;
			height: 13.4375rem;
			/* We use line-height: 1px; to get identical rendering across
			   FF/Chrome. line-height: 0; Does not render the same. */
			line-height: 1px;
			font-size: 0;

			/* Compensate for border. */
			vertical-align: -13.4375rem;
			/*border: 2px solid grey;*/
			width: 100%;
			margin-right: -100%;
			box-sizing: border-box;
			background-color: grey;
			overflow: hidden;
			position: relative;
			font-family: Helvetica, sans-serif;
		}

		.lead-block + h1 {
			display: inline-block;
			width: 100%;
			font-weight: 300;
			font-size: 3.75rem;
			color: rgba(0,0,0,0.5);
		}

		.lead-block > .float-block {
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			line-height: 30px;
			padding-top: 3.75rem;
			background-image: linear-gradient(to bottom, #8C7F7C 0%, #C1BCBA 18%, #E8E5E1 42%, #EFEEEA 100%);
		}

		.inline-block {
			display: inline-block;
		}

		.inline-h1 {
			display: inline-block;
			width: 100%;
			font-weight: 300;
			font-size: 3.875rem;
			line-height: 2.4375rem;
			color: rgba(0,0,0,0.5);
			font-family: Helvetica, sans-serif;
			letter-spacing: -0.033333333em;
			color:  white;
			z-index: 1;
			margin-top: 0;
			position: relative;
			letter-spacing: -1px;
			box-sizing: border-box;
			/* It flickers when other things animate. */
			/*text-shadow: 0 0 100px #402F20;*/
			/*letter-spacing: -1px;
			opacity: 1;
			transition:
				opacity 2000ms linear,
				letter-spacing 2600ms cubic-bezier(0, 0, 0, 1);
			*/
		}

		/*
		.loading .inline-h1 {
			opacity: 0.76;
			letter-spacing: -6px;
		}
		*/

		.inline-h1 > .grid-block {
			margin-top: 0;
		}

		.inline-h1 > .grid-block > .logo {
			vertical-align: -2.5rem;
			margin-left: -0.625rem;
		}

		.inline-h1 + .lead-block {
			margin-left: -100%;
			margin-right: 0;
		}

		.logo {
			display: inline-block;
			vertical-align: -20px;
			width: 152px;
			height: auto;
			margin-top: 30px;
			margin-left: calc(45% - 220px);
		}

		.test-block {
			display: inline-block;
			width: 46%;
			padding-top: 0.5rem;
			padding-bottom: 0.5rem;
			min-height: 8rem;
			margin-left: 2%;
			margin-right: 2%;
			vertical-align: top;
		}

		.test-block + .test-block + .test-block {
			border-top: 1px solid #888888;
		}

		.clock-block {
			position: relative;
			width: 10rem;
			height: 10rem;
			background-color: white;
			border: 2px solid #777777;
			border-radius: 50%;
		}

		.clock-block::after {
			content: '';
			position: absolute;
			top: 50%;
			left: 50%;
			width: 6%;
			height: 6%;
			margin-top: -3%;
			margin-left: -3%;
			background-color: white;
			border-radius: 50%;
		}

		.clock-block > .hand {
			position: absolute;
			top: 0;
			left: 50%;
			height: 50%;
			transition: transform 120ms cubic-bezier(0.82, 2.11, 0.07, 0.23);
		}

		.clock-block > .hour-hand {
			top: 10%;
			height: 40%;
		}

		.clock-block > .min-hand {
			top: 2%;
			height: 48%;
			transition: transform 100ms cubic-bezier(0.6, 2.18, 0.63, 0.54);
		}

		.clock-block > .sec-hand {
			top: 2%;
			height: 48%;
		}

		.hour-hand {
			margin-left: -2px;
			border-left: 4px solid black;
		}

		.min-hand {
			margin-left: -2px;
			border-left: 4px solid black;
		}

		.sec-hand {
			color: red;
			margin-left: -1px;
			border-left: 1px solid currentcolor;
			border-right: 1px solid currentcolor;
		}

		.sec-hand::after {
			content: '';
			position: absolute;
			top: -1px;
			left: 0;
			width: 14px;
			height: 14px;
			margin-top: 0;
			margin-left: -7px;
			background-color: currentcolor;
			border-radius: 50%;
		}

		.text-2    { font-family: Fira, Helvetica, Arial, sans-serif; font-size: 1.25rem; font-weight: 400; }
		.text-7    { font-family: Courier, monospace;                 font-size: 1.125rem; font-weight:300; letter-spacing: -0.04em; }
		.text-9    { font-family: Fira, Helvetica, Arial, sans-serif; font-size: 0.75rem; font-weight: 300; }

		.test-button {
			font-family: Fira, Helvetica, Arial, sans-serif;
			font-size: 12px;
			text-transform: uppercase;
			color: white;
			line-height: 40px;
			padding-left: 12px;
			padding-right: 12px;
			border-radius: 0.375rem;
		}

		.mud-color { color: #495973; }

		.red-bg    { background-color: #FF001A; }
		.orange-bg { background-color: #DD5827; }
		.blue-bg   { background-color: #1A83B7; }

		svg { overflow: visible; }

		.red-stroke-color    { stroke-width: 3px; stroke: #FF001A; fill: #691C24; }
		.orange-stroke-color { stroke-width: 3px; stroke: #DD5827; fill: #E6E7E8; }
		.blue-stroke-color   { stroke-width: 3px; stroke: #1A83B7; fill: #E6E7E8; }

		.step-0,
		.step-1,
		.step-2,
		.step-3,
		.step-4,
		.step-5,
		.step-6,
		.step-7,
		.step-8,
		.step-9 {
			max-height: 0;
			opacity: 0;
			visibility: hidden;

			transition:
				max-height 0ms linear,
				opacity 200ms linear,
				visibility 200ms linear;
		}

		.active-0 .step-0,
		.active-1 .step-1,
		.active-2 .step-2,
		.active-3 .step-3,
		.active-4 .step-4,
		.active-5 .step-5,
		.active-6 .step-6,
		.active-7 .step-7,
		.active-8 .step-8,
		.active-9 .step-9 {
			max-height: 10rem;
			opacity: 1;
			visibility: visible;

			transition:
				max-height 300ms ease-in,
				opacity 400ms linear,
				visibility 400ms linear;
		}
	</style>
</head>

<body>

	<h1 class="inline-h1">
		<div class="grid-block block">
			<div class="block baseline-align">Sparky</div>
			<img class="block logo" src="images/sparky-logo-218x333.png" />
		</div>
	</h1

	><div class="lead-block block">
		<div class="float-block block">
			<div class="grid-block block">
				<p class="block grid-2/3 text-2 mud-color">
					A live data binding templating engine that enhances
					HTML/SVG with tags and scopes and composeable templates,
					and applies granular data changes to the DOM on browser frames for
					performance.
				</p

				><ul class="block index grid-1/3 text-8">
					<li><b class="grid-1/3" style="display: inline-block">Repo</b><a href="http://github.com/cruncher/sparky/">github.com/cruncher/sparky</a></li>
					<li><b class="grid-1/3" style="display: inline-block">JS</b><div class="inline-block block">
						<a href="package/sparky.js" target="_blank">sparky.js</a> <small>100kB</small></br>
						<a href="package/sparky.min.js" target="_blank">sparky.min.js</a> <small>40kB</small>
						</div>
					</li>
					<li><b class="grid-1/3" style="display: inline-block">Author</b><a href="http://stephen.band">stephen.band</a></li>
				</ul>
			</div>
		</div>
	</div>

<script src="modules/jquery/jquery-2.1.1.js"></script>
<script src="modules/prettify/prettify.js"></script>

<script src="modules/object.assign/object.assign.js"></script>
<script src="modules/polyfills/number.isnan.js"></script>
<script src="modules/polyfills/math.log10.js"></script>
<script src="modules/polyfills/window.console.group.js"></script>
<script src="modules/polyfills/window.customevent.js"></script>
<script src="modules/polyfills/window.requestanimationframe.js"></script>
<script src="modules/collection/js/observe.js"></script>
<script src="modules/collection/js/mixin.events.js"></script>
<script src="modules/collection/js/collection.js"></script>

<script src="js/sparky.js"></script>
<script src="js/sparky.dom.js"></script>
<script src="js/sparky.observe.js"></script>
<script src="js/sparky.throttle.js"></script>
<script src="js/sparky.render.js"></script>
<script src="js/sparky.parse.js"></script>
<script src="js/sparky.fn.js"></script>
<script src="js/sparky.fn.each.js"></script>
<script src="js/sparky.fn.value.js"></script>
<script src="js/sparky.filters.js"></script>
<!--script src="js/sparky.ready.js"></script-->

<script src="js/sparky.fn.code.js"></script>



<!-- Cart Example -->

<div class="grid-block block active-{{step}}" id="cart-example" data-fn="example">
	<h1 class="block grid-1/1">How it works</h1>
	<div class="block grid-1/3" id="cart-html">
<div data-fn="cart">
  <ul data-scope="{{items}}" data-template="cart-items">
    <li>
      <h2>Rope</h2>
      <p>Strong nylon rope.</p>
      <p>Quantity: 3m</p>
      <a href="cart/items/0/quantity">Change</a>
      <a href="cart/items/0/remove">Remove</a>
    </li>
  </ul>
</div>
	</div

	><div class="block grid-2/3">
		<p>
		This example progressively enhances an imaginary shopping cart.
		Here's the HTML from the server with one item in the cart.
		</p>

		<pre><code class="html" data-fn="template-text" data-template="cart-html"></code></pre>


		<h3 class="text-4">data-fn</h3>
		<p>
		Sparky's three attributes <code>data-scope</code>, <code>data-fn</code>
		and <code>data-template</code> wire up the DOM.
		<code>data-fn="cart"</code> calls a function that returns
		an object for Sparky to use as render scope.
		</p>

		<pre><code class="js" data-fn="template-text" data-template="cart-script-1"></code></pre>

		<h3 class="text-4">data-scope</h3>
		<p>
		Next, <code data-fn="ignore">data-scope="{{items}}"</code> finds <code>items</code> in the
		current scope and uses that as scope for the
		<code class="tag-code">ul</code>. Except that it doesn't yet,
		becuase <code>cart.items</code> has not been defined. Instead, Sparky
		waits for that data to become available, and in the meantime continues
		parsing.
		</p>

		<h3 class="text-4">data-template</h3>
		<p>
		At <code>data-template="cart-items"</code> Sparky looks for a
		<code class="tag-code">template</code> with that id and parses it's
		contents instead of the contents of the <code class="tag-code">ul</code>.
		</p>

		<pre><code>&lt;template id="cart-items"&gt;</code>
  <code class="js" data-fn="template-text" data-template="cart-items"></code>
<code>&lt;/template&gt;</code></pre>

		<h3 class="text-4">Load some data&hellip;</h3>
		<p>
		Sparky now has a model of the enhanced DOM in his head ready to be
		populated with data, but the template is not yet inserted because the
		scope for the <code class="tag">ul</code> is not defined. So let's go
		ahead and see what happens when data is 'loaded':
		</p>

		<pre class="step-0 step-1 step-2"><code class="js">cart.items = Collection([{
  title: "Rope",
  description: "Strong nylon rope.",
  quantity: 3,
  units: 'm'
}]);</code></pre>

		<button class="step-0" data-fn="click-step">Define <code>cart.items</code></button>

		<h3 class="step-1 step-2 text-4">&hellip;and Sparky renders</h3>
		<p class="step-1 step-2">
		The static contents of the <code class="tag-code">ul</code>
		were replaced and the list is now dynamic. Objects added to
		<code>cart.items</code> make Sparky update the list.
		</p>

		<pre class="step-1 step-2"><code class="js">cart.items.add({
  title: "Gaffa Tape",
  description: "Fixes anything.",
  quantity: 2,
  units: ''
});</code></pre>

		<button data-fn="click-step" class="step-1">Add the item</button>

		<p class="step-2">
		Changes made to the inputs in the list are reflected in the data.
		For example, in the cart try changing the quantity of Gaffa Tape.
		</p>
		<pre class="step-2"><code data-fn="cart-gaffa">cart.items[1].quantity = <b style="font-size: 1.5em;">{{quantity}}</b>;</code></pre>

		<h3 class="text-4 step-2">That's it.</h3>

		<p class="step-2">
		That's Sparky in a nutshell.
		</p>
		<p>
		The <code>cart</code> object is exposed on <code>window</code> in
		case you would like to play with it in the console.
		</p>
		<p>
		Sparky is designed to be simple. It has some other nifty features –
		but that's the gist of it.
		</p>
	</div>

<template id="cart-items">
  <li data-fn="each">
    <h2>{{title}}</h2>
    <p>{{description}}</p>
    <form>
      <label>Quantity <input type="number" name="{{quantity}}" min="1"/> {{units}}</label>
      <button data-fn="click-to-destroy">Remove</button>
    </form>
  </li>
</template>

	<script id="cart-script-1">
var cart = {};

Sparky.fn.cart = function(node) {
  return cart;
};
</script>

	<script>
	var gaffa = {
		title: "Gaffa Tape",
		description: "Fixes anything.",
		quantity: 2,
		units: 'rolls'
	};

	Sparky.fn['click-to-run'] = function(node) {

	};

	Sparky.fn['click-to-destroy'] = function(node) {

	};

	Sparky.fn['cart-gaffa'] = function(node) {
		return gaffa;
	};

	Sparky.fn.example = function() {
		var scope = {
			step: 0,
			actions: [
				function() {
					cart.items = Collection([{
						title: "Rope",
						description: "Strong nylon rope.",
						quantity: 3,
						units: 'm'
					}]);
				},

				function() {
					cart.items.add(gaffa);
				},

				Sparky.noop
			]
		};

		function nextStep() {
			scope.actions[scope.step]();
			scope.actions[scope.step] = Sparky.noop;

			if (scope.step < scope.actions.length) {
				++scope.step;
			}
		}

		this.fn['click-step'] = function(node) {
			node.addEventListener('click', nextStep);
			node.addEventListener('click', function() {
				node.removeEventListener();
				Sparky.dom.remove(node);
			})
		};

		return scope;
	};

	Sparky('cart-example');
	</script>
</div>

<div class="grid-block block">
	<h1 class="block grid-1/1">Templates</h1>
	<div class="block grid-1/3">
		<h2>data-scope</h2>
		<h3 class="text-7"><code>data-scope="path.to.object"</code></h3>
		<p>
		Looks for an object inside the current Sparky's <code>data</code>
		object or inside <code>Sparky.data</code> to use as scope for the
		current node.
		</p>
		<h3 class="text-7"><code>data-scope="{{path.to.object}}"</code></h3>
		<p>
		Looks for an object inside the current scope to use as scope for the
		node.
		</p>
	</div

	><div class="block grid-1/3">
		<h2>data-fn</h2>
		<h3 class="text-7"><code>data-fn="name"</code></h3>
		<p>
		Looks for a function by name inside the current Sparky's <code>fn</code>
		object or inside <code>Sparky.fn</code> and runs it. If no function is
		found an error is thrown.
		</p>
		<h3 class="text-7"><code>data-fn="name1 name2"</code></h3>
		<p>
		Runs multiple functions, in order.
		</p>
	</div

	><div class="block grid-1/3">
		<h2>data-template</h2>
		<h3 class="text-7"><code>data-template="id"</code></h3>
		<p>
		Replaces the content of an element with the content of a template.
		</p>
	</div

	><div class="block grid-1/3">
		<h2>{{ tag }}</h2>
		<h3 class="text-7"><code>{{path.to.property}}</code></h3>
		<p>Rendered whenever the value of the property at the end of the path is changed.</p>
		<h3 class="text-7"><code>{{path.to.property|filter:''}}</code></h3>
		<p>Processes the value with one of the filters found in <code>Sparky.filters</code>.</p>
		<h3 class="text-7"><code>name="{{path.to.property}}"</code></h3>
		<p>
		Bi-directional data binding for values of <code>input</code>,
		<code>select</code> and <code>textarea</code> elements.
		</p>
	</div

	><div class="block grid-1/3">
		<h2>{{{ tag }}}</h2>
		<h3 class="text-7"><code>{{{path.to.property}}}</code></h3>
		<p>Rendered once, the first time the property has value.</p>
	</div

	><div class="block grid-1/3">
		<h2>Oops.</h2>
		<p>Tag delimiters clashing with another template engine? Change them:</p>
		<p><code>Sparky.tags(/\[{2,3}/, /\]{2,3}/);</code></p>
		<p>Now tags look like <code>[[this]]</code>. Probably best to do this before any of the DOM is parsed, ie. before DOMContentLoaded.</p>
	</div>
</div>




<div class="grid-block block">
	<h1 class="block grid-1/1">Functions</h1>

	<div class="block grid-1/4">
		<h2>Built ins</h2>
		<p>
		Sparky comes with a bunch of functions built in.
		</p>
		<ul class="index">
			<li><code>each</code></li>
			<li><code>ignore</code></li>
			<li><code>log</code></li>
			<li><code>prevent-click</code></li>
			<li><code>prevent-submit</code></li>
			<li><code>store-scope</code></li>
			<li><code>value-any</code></li>
			<li><code>value-bool</code></li>
			<li><code>value-float</code></li>
			<li><code>value-int</code></li>
			<li><code>value-string</code></li>
		</ul>
	</div

	><div class="block grid-3/4">
		<h2>Roll your own</h2>
		<p>
		Sparky's functions are called with a Sparky instance as context, giving
		them access to lifecycle events and control methods, and they are passed
		the <code>node</code> as the first parameter. In MVC-speak, they are
		view-controllers.
		</p>
		<p>
		Functions are run before the node's content and attributes are parsed
		and they watch for initialisation and changes using Sparky's lifecycle
		events. They may modify or overwrite the instance's <code>fn</code> and
		<code>data</code> objects, providing descendent content access to
		'private' functions and data. They may also return an object to be
		used as a scope (in which case changes to outer scopes are ignored).
		</p>

		<pre><code class="" data-fn="template-text" data-template="function" id="function-code"></code></pre>

		<p>Read more: <a href="http://github.com/cruncher/sparky">Sparky API</a>.</p>

		<template id="function">
Sparky.fn['my-function'] = function(node) {
  // Do something when scope initialises or changes
  this.on('scope', function() { &hellip; });

  // Do something when node inserted into the DOM
  this.on('dom-add', function() { &hellip; });

  // Teardown anything you need to destroy
  this.on('destroy', function() { &hellip; });

  // Define functions only available to descendents
  Object.assign(this.fn, {
    'private-fn': function() { &hellip; })
  });

  // Define data only available to descendents
  Object.assign(this.data, {
    'private-data': { &hellip; }
  });

  // Return a scope, or not
  return {};
};
</template>

		<script>
		Sparky('function-code');
		</script>
	</div>
</div>


<footer class="grid-block block">
	<hr class="block grid-1/1" />
	<p class="block grid-1/2">Made at <a href="http://cruncher.ch">Cruncher</a></p>
</footer>

<!-- Clock -->

<!--template id="clock">
<div class="clock-block block" data-fn="clock">
  <div class="hour-hand hand" style="transform: translate(0, 50%) rotate({{time|date:'h'|multiply:30|mod:360}}deg) translate(0, -50%);"></div>
  <div class="min-hand hand" style="transform: translate(0, 50%) rotate({{time|date:'i'|multiply:6|mod:360}}deg) translate(0, -50%);"></div>
  <div class="sec-hand hand" style="transform: translate(0, 50%) rotate({{time|date:'s'|multiply:6|mod:360}}deg) translate(0, -50%);"></div>
</div>
</template>

<template id="clock-html">
<div class="clock-block block" data-fn="clock">
  <div class="hour-hand hand" style="transform: rotate({{time|date:'h'|multiply:30|mod:360}}deg);"></div>
  <div class="min-hand hand" style="transform: rotate({{time|date:'i'|multiply:6|mod:360}}deg);"></div>
  <div class="sec-hand hand" style="transform: rotate({{time|date:'s'|multiply:6|mod:360}}deg);"></div>
</div>
</template>

<script id="Sparky.fn.clock">
Sparky.fn.clock = function(node) {
  var scope = { time: new Date() };

  setInterval(function() {
    scope.time = new Date();
  }, 1000);

  return scope;
};
</script-->

</body>
</html>

<!DOCTYPE html><html lang="en" is="sparky" class="js fullscreen-support"><head>
    <meta charset="utf-8">

    <meta name="author" content="@stephband">
    <meta name="description" content="Documentation for Sparky. Sparky is a live data-binding controller who wires up HTML templates with template tags, composeable includes, functional views and a DOM renderer that batches updates to the browser frame rate.">
    <meta name="viewport" content="width=device-width">

    <title>Sparky</title>

    <script>
    document.documentElement.className = 'js';
    window.DEBUG = false;
    window.config = {
        path: 'https://stephen.band/'
    };
    </script>

    <link rel="shortcut icon" href="images/logo-64x64.ico">
    <link rel="icon" type="image/png" href="images/logo-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="images/logo-64x64.png" sizes="64x64">
    <link rel="icon" type="image/png" href="images/logo-128x128.png" sizes="128x128">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:100,300,400,500,700">

    
        <link rel="stylesheet" href="https://stephen.band/bolt/css/html.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/root.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/body.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/block.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/bubble.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/button.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/dialog.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/layer.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/type.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/text.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/color.css">
        <link rel="stylesheet" href="https://stephen.band/dom/css/dom.css">
        <link rel="stylesheet" href="https://stephen.band/fn/css/prism-cruncher.css">
        <link rel="stylesheet" href="https://stephen.band/fn/css/tests.css">
        <link rel="stylesheet" href="https://stephen.band/fn/css/docs.css">
        <link rel="stylesheet" href="css/theme.css">
        <link rel="stylesheet" href="https://stephen.band/fn/css/respond.css">
    
<template id="header-template" title="/fn/">
        <h1>{[title]} <span class="text-6">{[version]}</span></h1>

        <p class="text-8">
            {[description]}
        </p>

        <ul class="link-index index">
            <li><strong>repo:</strong> <a href="{[repository.url]}">{[repository.url]}</a></li>
            <li><strong>bugs:</strong> <a href="{[bugs.url]}">{[bugs.url]}</a></li>
        </ul>
</template><template id="title-template" title="/fn/">
    <h3 class="text-4" build-fn="after:body">{[name]}</h3>
</template><template id="attribute-template" title="/fn/">
    <article build-fn="append:body" class="attribute-toggle-block toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5">
            <a href="#{[id]}">
                <code class="token language-js"><span>[</span><span build-fn="append:title"></span><span>]</span></code>
            </a>
        </h3>

        <pre><code class="language-js">import '/dom/js/{[name]}.js';</code></pre>
    </article>
</template><template id="method-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <a href="#{[id]}">
                <code build-fn="append:title" class="function language-js"></code>
            </a>
        </h3>
    </article>
</template><template id="property-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <a href="#{[id]}">
                <code build-fn="append:title" class="property language-js"></code>
            </a>
        </h3>
    </article>
</template><template id="function-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <a href="#{[id]}">
                <code build-fn="append:title" class="function language-js"></code>
            </a>
        </h3>
    </article>
</template><template id="fn-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <a href="#{[id]}">
                <code build-fn="append:title" class="language-js"></code>
            </a>
        </h3>
    </article>
</template><template id="section-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block active" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <code build-fn="append:title" class="function language-js"></code>
        </h3>
    </article>
</template><template id="body-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block active" id="{[id]}"></article>
</template></head>

<body class="@3-grid-12 grid">
    <img class="x-1 xspan-3 @1-xspan-3 @3-x-2 @3-xspan-2" src="images/sparky-logo-dark.svg">

    <header class="x-1 xspan-3 @2-xspan-6 @3-x-2" id="header">
        
        <h1>Sparky <span class="text-6">3.1.2</span></h1>

        <p class="text-8">
            Sparky is a live data-binding controller who wires up HTML templates with template tags, composeable includes, functional views and a DOM renderer that batches updates to the browser frame rate.
        </p>

        <ul class="link-index index">
            <li><strong>repo:</strong> <a href="https://github.com/cruncher/sparky.git">https://github.com/cruncher/sparky.git</a></li>
            <li><strong>bugs:</strong> <a href="https://github.com/cruncher/sparky/issues">https://github.com/cruncher/sparky/issues</a></li>
        </ul>

    </header>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 grid" locateable="" id="functions">
        <div class="x-1 xspan-3">
            <h2 class="text-2">Sparky templates</h2>
            
    <article class="toggle-block block active" id="sparky-templates"><p>First, import Sparky:</p>
<pre><code class="language-js"><span class="token keyword">import</span> <span class="token string">'/sparky/module.js'</span><span class="token punctuation">;</span></code></pre>
<p>Sparky registers the <code>is="sparky-template"</code> custom element. Sparky templates
in the DOM are automatically replaced with their own rendered content:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    Hello!
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html">Hello!</code></pre>
<p>Sparky templates extend HTML with 3 features: <strong>template tags</strong>, <strong>functions</strong>
and <strong>includes</strong>.</p>
</article>

        </div>

        <div class="x-1 xspan-3">
            <h3 class="text-3">tags.</h3>
            
    <article class="toggle-block block active" id="path-pipe-params">
        <h3 class="text-5 ">
            <code class="function language-js">{[path|pipe:params]}</code>
        </h3>
    <p>Template tags are made of three parts. Values are read from <code>path</code> in the
scope object, piped through any number of <code>pipe</code> functions, which
(depending on the pipe) may require <code>params</code>, and rendered into the DOM.</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    {[ repository.url|prepend:'Repo: ' ]}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html">Repo: https://github.com/cruncher/sparky.git</code></pre>
<p>Paths are a superset of JS notation, where dashes and numbers are allowed in
property names. These are valid:</p>
<pre><code class="language-html">{[ items.my-object ]}
{[ items.3 ]}</code></pre>
<p>The root path renders the scope object itself:</p>
<pre><code class="language-html">{[ . ]}</code></pre>
<p>Sparky renders <code>NaN</code>, <code>null</code> and <code>undefined</code> as empty strings, objects as JSON,
functions as a <code>name(params)</code> shorthand, and <code>Infinity</code> as <code>∞</code>. Other values
are rendered as strings.</p>
</article>

        </div>

        <div class="x-1 xspan-3 @2-x-4">
            <h3 class="text-3">functions.</h3>
            
    <article class="toggle-block block active" id="fn">
        <h3 class="text-5 ">
            <code class="function language-js">fn="name:params"</code>
        </h3>
    <p>A <code>fn</code> attribute declares one or more functions to run on a template.
A <strong>function</strong> is expected to supply an object that Sparky uses to
render template <strong>tags</strong>:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    I am {[title]}.
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html">I am Sparky.</code></pre>
<p>The <code>fn</code> attribute may be declared on any element in a sparky template.
Here we use the built-in functions <code>fetch</code>, <code>get</code> and <code>each</code> to loop over an
array of keywords and generate a list:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:keywords each<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[.]}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>javascript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>browser<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

        </div>

        <div class="x-1 xspan-3 @2-x-7">
            <h3 class="text-3">includes.</h3>
            
    <article class="toggle-block block active" id="include">
        <h3 class="text-5 ">
            <code class="function language-js">include="#id"</code>
        </h3>
    <p>A template may include another template by referring to it via the <code>include</code>
attribute. The rendered content of the included template replaces the referring
template:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-template<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:keywords each<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[.]}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span> <span class="token attr-name">include</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#my-template<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>javascript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>browser<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Includes may be used inside templates, too:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">include</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#my-template<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>javascript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>browser<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>The <code>include</code> attribute may contain template tags, making the included template
dependent on rendered data. This is how conditionals are written in Sparky.
Here, where there is no <code>keywords</code> property in <code>package.json</code> the template
with id <code>no-keywords</code> is rendered in place of <code>my-template</code>:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">include</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{[.keywords|yesno:#my-template,#no-keywords]}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

        </div>
    </section>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 column-grid grid" locateable="" id="built-ins">
        <div class="x-1 xspan-3">
            <h2 class="text-3">built-in functions.</h2>
            
    <article class="toggle-block block" toggleable="" id="each">
        <h3 class="text-5 ">
            <a href="#each">
                <code class="language-js">each</code>
            </a>
        </h3>
    <p>Clones the DOM node and renders a clone for each value in an array.</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:keywords each<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[.]}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>javascript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>browser<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Where there are functions declared after <code>each</code> in the attribute, they are run
on each clone.</p>
</article>

    <article class="toggle-block block" toggleable="" id="entries">
        <h3 class="text-5 ">
            <a href="#entries">
                <code class="language-js">entries</code>
            </a>
        </h3>
    <p>Maps scope to an array of <code>[key, value]</code> arrays.</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:repository entries each<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[0]}: {[1]}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>type: git<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>url: https://github.com/cruncher/sparky.git<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

    <article class="toggle-block block" toggleable="" id="fetch">
        <h3 class="text-5 ">
            <a href="#fetch">
                <code class="language-js">fetch: url</code>
            </a>
        </h3>
    <p>Fetches and parses a JSON file and uses it as scope to render the node.</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[title]}!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Sparky!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

    <article class="toggle-block block" toggleable="" id="get">
        <h3 class="text-5 ">
            <a href="#get">
                <code class="language-js">get: path</code>
            </a>
        </h3>
    <p>Maps scope to the value at <code>path</code> of the current scope:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:repository<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{[ url ]}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[type|capitalise]} repository<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://github.com/cruncher/sparky.git<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Git repository<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

        </div>

        <div class="x-1 xspan-3 @2-x-4 @2-xspan-6 @2-columns-2">
            <h2 class="text-3">built-in pipes.</h2>
            
    <article class="toggle-block block" toggleable="" id="add">
        <h3 class="text-5 ">
            <a href="#add">
                <code class="language-js">add: n</code>
            </a>
        </h3>
    <p>Adds <code>n</code> to value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="add-date">
        <h3 class="text-5 ">
            <a href="#add-date">
                <code class="language-js">add-date: yyyy-mm-dd</code>
            </a>
        </h3>
    <p>Adds ISO formatted <code>yyyy-mm-dd</code> to a date value, returning a new date. </p>
</article>

    <article class="toggle-block block" toggleable="" id="add-time">
        <h3 class="text-5 ">
            <a href="#add-time">
                <code class="language-js">add-time: 'hh:mm:ss'</code>
            </a>
        </h3>
    <p>Adds an ISO time in the form <code>'hh:mm:ss'</code> to a time value. (Note this
    string must be quoted because it contains ‘:’ characters.) </p>
</article>

    <article class="toggle-block block" toggleable="" id="to-db">
        <h3 class="text-5 ">
            <a href="#to-db">
                <code class="language-js">to-db</code>
            </a>
        </h3>
    <p>Converts value to dB scale. </p>
</article>

    <article class="toggle-block block" toggleable="" id="to-precision">
        <h3 class="text-5 ">
            <a href="#to-precision">
                <code class="language-js">to-precision: n</code>
            </a>
        </h3>
    <p>Converts number to string representing number to precision <code>n</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="normalise">
        <h3 class="text-5 ">
            <a href="#normalise">
                <code class="language-js">normalise: curve, min, max</code>
            </a>
        </h3>
    <p>Return a value in the nominal range <code>0-1</code> from a value between <code>min</code> and
    <code>max</code> mapped to a <code>curve</code>, which is one of <code>linear</code>, <code>quadratic</code>, <code>exponential</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="denormalise">
        <h3 class="text-5 ">
            <a href="#denormalise">
                <code class="language-js">denormalise: curve, min, max</code>
            </a>
        </h3>
    <p>Return a value in the range <code>min</code>-<code>max</code> of a value in the range <code>0</code>-<code>1</code>,
    reverse mapped to <code>curve</code>, which is one of <code>linear</code>, <code>quadratic</code>, <code>exponential</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="floatformat">
        <h3 class="text-5 ">
            <a href="#floatformat">
                <code class="language-js">floatformat: n</code>
            </a>
        </h3>
    <p>Returns a number fixed to <code>n</code> decimal places from value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="float-string">
        <h3 class="text-5 ">
            <a href="#float-string">
                <code class="language-js">float-string</code>
            </a>
        </h3>
    <p>Converts float values to strings. </p>
</article>

    <article class="toggle-block block" toggleable="" id="int-string">
        <h3 class="text-5 ">
            <a href="#int-string">
                <code class="language-js">int-string</code>
            </a>
        </h3>
    <p>Converts int values to strings. </p>
</article>

    <article class="toggle-block block" toggleable="" id="formatdate">
        <h3 class="text-5 ">
            <a href="#formatdate">
                <code class="language-js">formatdate: format</code>
            </a>
        </h3>
    <p>Converts a date object, ISO date string or UNIX time number (in seconds) to
    string in <code>format</code>.</p>
</article>

    <article class="toggle-block block" toggleable="" id="formattime">
        <h3 class="text-5 ">
            <a href="#formattime">
                <code class="language-js">formattime: format</code>
            </a>
        </h3>
    <p>Converts ISO time string, a number (in seconds) or the UTC time values of
    a date object to a string formatted to <code>format</code>.</p>
</article>

    <article class="toggle-block block" toggleable="" id="is">
        <h3 class="text-5 ">
            <a href="#is">
                <code class="language-js">is: a</code>
            </a>
        </h3>
    <p>Returns <code>true</code> where value is strictly equal to <code>a</code>, otherwise <code>false</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="has">
        <h3 class="text-5 ">
            <a href="#has">
                <code class="language-js">has: property</code>
            </a>
        </h3>
    <p>Returns <code>true</code> where value is an object with the property <code>name</code>, otherwise <code>false</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="append">
        <h3 class="text-5 ">
            <a href="#append">
                <code class="language-js">append: string</code>
            </a>
        </h3>
    <p>Returns value + <code>string</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="prepend">
        <h3 class="text-5 ">
            <a href="#prepend">
                <code class="language-js">prepend: string</code>
            </a>
        </h3>
    <p>Returns <code>string</code> + value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="slugify">
        <h3 class="text-5 ">
            <a href="#slugify">
                <code class="language-js">slugify</code>
            </a>
        </h3>
    <p>Returns the slug of value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="root">
        <h3 class="text-5 ">
            <a href="#root">
                <code class="language-js">root: n</code>
            </a>
        </h3>
    <p>Returns the <code>n</code>th root of value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="type">
        <h3 class="text-5 ">
            <a href="#type">
                <code class="language-js">type</code>
            </a>
        </h3>
    <p>Returns the <code>typeof</code> value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="floor">
        <h3 class="text-5 ">
            <a href="#floor">
                <code class="language-js">floor</code>
            </a>
        </h3>
    <p>Floors a numeric value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="localise">
        <h3 class="text-5 ">
            <a href="#localise">
                <code class="language-js">localise: n</code>
            </a>
        </h3>
    <p>Localises a number to <code>n</code> digits. </p>
</article>

    <article class="toggle-block block" toggleable="" id="lowercase">
        <h3 class="text-5 ">
            <a href="#lowercase">
                <code class="language-js">lowercase</code>
            </a>
        </h3>
    <p>Returns the lowercase string of value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="pluralise">
        <h3 class="text-5 ">
            <a href="#pluralise">
                <code class="language-js">pluralise: str1, str2, lang</code>
            </a>
        </h3>
    <p>Where value is singular in a given <code>lang</code>, retuns <code>str1</code>, otherwise <code>str2</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="yesno">
        <h3 class="text-5 ">
            <a href="#yesno">
                <code class="language-js">yesno: a, b</code>
            </a>
        </h3>
    <p>Where value is truthy returns <code>a</code>, otherwise <code>b</code>. </p>
</article>

        </div>
    </section>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 column-grid grid" locateable="" id="customise">
        <div class="x-1 xspan-3 @2-xspan-5">
            <h2 class="text-2">Write a function</h2>

            
    <h3 class="text-4">Register</h3><p>Sparky ‘functions’ are view-controllers with access to the node where they are
declared and control over the flow of objects being sent to the renderer. They
are registered and accessed by a string identifier.</p>
<pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> register <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./sparky/module.js'</span><span class="token punctuation">;</span>

<span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'my-function'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// `this` is a stream of scope objects</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>scope<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Map scope...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Functions are called before a node is mounted. They receive a stream of scopes
and the DOM node, and may return the same stream, or a new stream, or they may
block mounting and rendering altogether. Types of return value are interpreted
as follows:</p>
<ul>
<li><code>Promise</code> - automatically converted to a stream</li>
<li><code>Stream</code> - a stream of scopes</li>
<li><code>undefined</code> - equivalent to returning the input stream</li>
<li><code>false</code> - cancels the mount process</li>
</ul>
<p>The stream returned by the last function declared in the <code>fn</code> attribute is
piped to the renderer. Values in that stream are rendered, and the life
of the renderer is controlled by the state of that stream. Sparky’s streams
come from <a href="https://stephen.band/fn/#stream">stephen.band/fn/#stream</a>.</p>



            <h3 class="text-3">Examples</h3>

            
    <h3 class="text-4">Examples</h3><p>Push a single scope object to the renderer:</p>
<pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> register<span class="token punctuation">,</span> Stream <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./sparky/module.js'</span><span class="token punctuation">;</span>

<span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'my-scope'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Return a stream of one object</span>
    <span class="token keyword">return</span> Stream<span class="token punctuation">.</span><span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        text<span class="token punctuation">:</span> <span class="token string">'Hello, Sparky!'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Return a promise to push a scope when it is ready:</p>
<pre><code><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'my-package'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Return a promise</span>
    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'package.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Push a new scope object to the renderer every second:</p>
<pre><code><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'my-clock'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> output <span class="token operator">=</span> Stream<span class="token punctuation">.</span><span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Push a new scope to the renderer once per second</span>
    <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        output<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            time<span class="token punctuation">:</span> window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Listen to the input stream, stop the interval</span>
    <span class="token comment">// timer when it is stopped</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Return the stream</span>
    <span class="token keyword">return</span> output<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

        </div>

        <div class="x-1 xspan-3 @2-x-6 @2-xspan-4">
            <h3 class="text-3">Function helpers</h3>

            
    <article class="toggle-block block" toggleable="" id="delegate-types">
        <h3 class="text-5 ">
            <a href="#delegate-types">
                <code class="function language-js"><span class="token function">delegate</span><span class="token punctuation">(</span>types<span class="token punctuation">)</span></code>
            </a>
        </h3>
    <p>Create an event delegation controller fn, where <code>types</code> is an object of objects
mapping event types and selectors to listener functions:</p>
<pre><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> delegate<span class="token punctuation">,</span> register <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./sparky/module.js'</span><span class="token punctuation">;</span>

<span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'fn-name'</span><span class="token punctuation">,</span> <span class="token function">delegate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'click'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'button'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>button<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Button was clicked...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>To further delegate by the name of the button you could use <code>get</code>
and <code>overload</code> from Fn:</p>
<pre><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> delegate<span class="token punctuation">,</span> register <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./sparky/module.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">,</span> overload <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./fn/module.js'</span><span class="token punctuation">;</span>

<span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'fn-name'</span><span class="token punctuation">,</span> <span class="token function">delegate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'click'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'button[name]'</span><span class="token punctuation">:</span> <span class="token function">overload</span><span class="token punctuation">(</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token string">'button-name'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Button name="button-name" was clicked...</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>(This is a little more efficient than listing all possible button names as
selectors).</p>
</article>

        </div>
    </section>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 column-grid grid" locateable="" id="customise">
        <div class="x-1 xspan-3 @2-xspan-5">
            <h2 class="text-2">Write a pipe</h2>

            
    <h3 class="text-4">Write</h3><p>Todo.</p>


        </div>

        <div class="x-1 xspan-3 @2-x-6 @2-xspan-4">
            <h3 class="text-3">Examples</h3>

            
    <h3 class="text-4">Examples</h3><p>Todo.</p>


        </div>
    </section>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 columns-grid grid" locateable="" id="attributes">
        <header class="x-1 xspan-3 @1-xspan-4 block">
            <h2 class="text-2">API</h2>
        </header>

        <div class="x-1 xspan-3">
            
    <article class="toggle-block block" toggleable="" id="sparky-nodeorselector">
        <h3 class="text-5 ">
            <a href="#sparky-nodeorselector">
                <code class="function language-js"><span class="token function">Sparky</span><span class="token punctuation">(</span>nodeOrSelector<span class="token punctuation">)</span></code>
            </a>
        </h3>
    <p>Mounts any element as a template and returns a pushable stream. Push an object
to the stream to have it rendered by the template:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title-div<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    I am {[title]}.
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code><span class="token keyword">import</span> Sparky <span class="token keyword">from</span> <span class="token string">'/sparky/module.js'</span><span class="token punctuation">;</span>

<span class="token comment">// Mount the &lt;div&gt;</span>
<span class="token keyword">const</span> sparky <span class="token operator">=</span> <span class="token function">Sparky</span><span class="token punctuation">(</span><span class="token string">'#title-div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Render it by pushing in an object</span>
sparky<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">'rendered'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Results in:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title-div<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    I am rendered.
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

        </div>
    </section>

    <aside class="x-1 xspan-3 @2-x-2 @2-xspan-6 text-9">
        <h4 class="text-4">A note to the Django enthusiast</h4>
        <p>By now, you'll have noticed some similarities between Django and Sparky: template-led views, tags with filters and so on. Yes, Sparky was influenced by Django at <a href="https://cruncher.ch">Cruncher</a>, where we frequently write hybrid back-end/front-end templates, hence the similar syntax. They play quite nice together!</p>
    </aside>

    <!-- Build document -->
    

    <!-- Document interactivity -->
    <script type="module">
        import 'https://stephen.band/dom/js/device.js';
        import 'https://stephen.band/dom/js/popable.js';
        import 'https://stephen.band/dom/js/toggleable.js';
        import 'https://stephen.band/dom/js/locateable.js';
        import 'https://stephen.band/dom/js/switchable.js';
        import 'https://stephen.band/dom/js/fullscreenable.js';
        //import * as sparky from './build/module.js';
        //window = sparky;
    </script>

</body></html>
<!DOCTYPE html><html lang="en" is="sparky" class="js fullscreen-support"><head>
    <meta charset="utf-8">

    <meta name="author" content="@stephband">
    <meta name="description" content="Documentation for Sparky. Sparky is a live data-binding controller who wires up HTML templates with template tags, composeable includes, functional views and a DOM renderer that batches updates to the browser frame rate.">
    <meta name="viewport" content="width=device-width">

    <title>Sparky</title>

    <script>
    document.documentElement.className = 'js';
    window.DEBUG = false;
    window.config = {
        path: 'https://stephen.band/'
    };
    </script>

    <link rel="shortcut icon" href="images/logo-64x64.ico">
    <link rel="icon" type="image/png" href="images/logo-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="images/logo-64x64.png" sizes="64x64">
    <link rel="icon" type="image/png" href="images/logo-128x128.png" sizes="128x128">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:100,300,400,500,700">


        <link rel="stylesheet" href="https://stephen.band/bolt/css/html.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/root.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/body.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/block.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/bubble.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/button.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/dialog.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/layer.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/type.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/text.css">
        <link rel="stylesheet" href="https://stephen.band/bolt/css/color.css">
        <link rel="stylesheet" href="https://stephen.band/dom/css/dom.css">
        <link rel="stylesheet" href="https://stephen.band/fn/css/prism-cruncher.css">
        <link rel="stylesheet" href="https://stephen.band/fn/css/tests.css">
        <link rel="stylesheet" href="https://stephen.band/fn/css/docs.css">
        <link rel="stylesheet" href="css/theme.css">
        <link rel="stylesheet" href="https://stephen.band/fn/css/respond.css">

<template id="header-template" title="/fn/">
        <h1>{[title]} <span class="text-6">{[version]}</span></h1>

        <p class="text-8">
            {[description]}
        </p>

        <ul class="link-index index">
            <li><strong>repo:</strong> <a href="{[repository.url]}">{[repository.url]}</a></li>
            <li><strong>bugs:</strong> <a href="{[bugs.url]}">{[bugs.url]}</a></li>
        </ul>
</template><template id="title-template" title="/fn/">
    <h3 class="text-4" build-fn="after:body">{[name]}</h3>
</template><template id="attribute-template" title="/fn/">
    <article build-fn="append:body" class="attribute-toggle-block toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5">
            <a href="#{[id]}">
                <code class="token language-js"><span>[</span><span build-fn="append:title"></span><span>]</span></code>
            </a>
        </h3>

        <pre><code class="language-js">import '/dom/js/{[name]}.js';</code></pre>
    </article>
</template><template id="method-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <a href="#{[id]}">
                <code build-fn="append:title" class="function language-js"></code>
            </a>
        </h3>
    </article>
</template><template id="property-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <a href="#{[id]}">
                <code build-fn="append:title" class="property language-js"></code>
            </a>
        </h3>
    </article>
</template><template id="function-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <a href="#{[id]}">
                <code build-fn="append:title" class="function language-js"></code>
            </a>
        </h3>
    </article>
</template><template id="fn-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block" toggleable="" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <a href="#{[id]}">
                <code build-fn="append:title" class="language-js"></code>
            </a>
        </h3>
    </article>
</template><template id="section-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block active" id="{[id]}">
        <h3 class="text-5 {[prefix|is:'.'|yesno:'dot-indent','']}">
            <code build-fn="append:title" class="function language-js"></code>
        </h3>
    </article>
</template><template id="body-template" title="/fn/">
    <article build-fn="append:body" class="toggle-block block active" id="{[id]}"></article>
</template></head>

<body class="@3-12-grid grid">
    <img class="x-1 xspan-3 @1-xspan-3 @3-x-2 @3-xspan-2" src="images/sparky-logo-dark.svg">

    <header class="x-1 xspan-3 @2-xspan-6 @3-x-2" id="header">

        <h1>Sparky <span class="text-6">3.1.2</span></h1>

        <p class="text-8">
            Sparky is a live data-binding controller who wires up HTML templates with template tags, composeable includes, functional views and a DOM renderer that batches updates to the browser frame rate.
        </p>

        <ul class="link-index index">
            <li><strong>repo:</strong> <a href="https://github.com/cruncher/sparky.git">https://github.com/cruncher/sparky.git</a></li>
            <li><strong>bugs:</strong> <a href="https://github.com/cruncher/sparky/issues">https://github.com/cruncher/sparky/issues</a></li>
        </ul>

    </header>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 grid" locateable="" id="functions">
        <div class="x-1 xspan-3">
            <h2 class="text-2">Sparky templates</h2>

    <article class="toggle-block block active" id="sparky-templates"><p>First, import Sparky:</p>
<pre><code class="language-js"><span class="token keyword">import</span> <span class="token string">'/sparky/module.js'</span><span class="token punctuation">;</span></code></pre>
<p>Sparky registers the <code>is="sparky-template"</code> custom element. Sparky templates
in the DOM are automatically replaced with their own rendered content:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    Hello!
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html">Hello!</code></pre>
<p>Sparky templates extend HTML with 3 features: <strong>template tags</strong>, <strong>functions</strong>
and <strong>includes</strong>.</p>
</article>

        </div>

        <div class="x-1 xspan-3">
            <h3 class="text-3">tags.</h3>

    <article class="toggle-block block active" id="path-pipe-params">
        <h3 class="text-5 ">
            <code class="function language-js">{[path|pipe:params]}</code>
        </h3>
    <p>Template tags are made of three parts. Values are read from <code>path</code> in the
scope object, piped through any number of <code>pipe</code> functions, which
(depending on the pipe) may require <code>params</code>, and rendered into the DOM.</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    {[ repository.url|prepend:'Repo: '|lowercase ]}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html">repo: https://github.com/cruncher/sparky.git</code></pre>
<p>Paths are a sort-of superset of JS dot notation, where dashes and numbers are
allowed in property names:</p>
<pre><code class="language-html">{[ items.3 ]}
{[ items.my-object ]}</code></pre>
<p>The root path renders the scope object itself:</p>
<pre><code class="language-html">{[ . ]}</code></pre>
<p>And a  trailing <code>.</code> also renders the tag when the object at the path mutates:</p>
<pre><code class="language-html">{[ items.3. ]}
{[ items.my-object. ]}</code></pre>
<p>Sparky renders <code>NaN</code>, <code>null</code> and <code>undefined</code> as empty strings, objects as JSON,
functions as <code>'function(params)'</code>, and <code>Infinity</code> as <code>'∞'</code>. Other values
are converted to strings in the normal way.</p>
<p>Tags placed in an <code>&lt;input :value="{[]}"&gt;</code> set up two-way data binding.
Sparky is strict about input types. A number will not render into an
input <code>type="text"</code>. A string will not render into an input <code>type="number"</code> or
<code>type="range"</code>.</p>
<p>More importantly, a number typed into an input <code>type="text"</code> will be set as
a string in the data, while the same typed into a <code>type="number"</code> will be set
as a number. Sparky gaurantees your data types.</p>
<p>The built-in type converter pipes facilitate rendering values into inputs of
an unmatched type.</p>
</article>

        </div>

        <div class="x-1 xspan-3 @2-x-4">
            <h3 class="text-3">functions.</h3>

    <article class="toggle-block block active" id="fn">
        <h3 class="text-5 ">
            <code class="function language-js">fn="name:params"</code>
        </h3>
    <p>A <code>fn</code> attribute declares one or more functions to run on a template.
A <strong>function</strong> is expected to supply an object that Sparky uses to
render template <strong>tags</strong>:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    I am {[title]}.
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html">I am Sparky.</code></pre>
<p>The <code>fn</code> attribute may be declared on any element in a sparky template.
Here we use the built-in functions <code>fetch</code>, <code>get</code> and <code>each</code> to loop over an
array of keywords and generate a list:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:keywords each<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[.]}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>javascript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>browser<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

        </div>

        <div class="x-1 xspan-3 @2-x-7">
            <h3 class="text-3">includes.</h3>

    <article class="toggle-block block active" id="src">
        <h3 class="text-5 ">
            <code class="function language-js">src="#id"</code>
        </h3>
    <p>Sparky extends <code>&lt;template&gt;</code> elements (and <code>&lt;use&gt;</code> elements in SVG) with a <code>src</code>
attribute, turning them into includes. The <code>src</code> attribute must reference
another template (or sn SVG element). Its rendered content replaces the
referring template:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>my-template<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:keywords each<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[.]}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#my-template<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>javascript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>browser<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Includes may be used inside templates, too:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#my-template<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>javascript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>browser<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>The <code>src</code> attribute may contain template tags, making the included template
dependent on rendered data. This is how conditionals are written in Sparky.
Here, where there is no <code>keywords</code> property in <code>package.json</code> the template
with id <code>no-keywords</code> is rendered in place of <code>my-template</code>:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sparky-template<span class="token punctuation">"</span></span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{[.keywords|yesno:#my-template,#no-keywords]}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

        </div>
    </section>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 column-grid grid" locateable="" id="built-ins">
        <div class="x-1 xspan-3">
            <h2 class="text-3">built-in functions.</h2>

    <article class="toggle-block block" toggleable="" id="each">
        <h3 class="text-5 ">
            <a href="#each">
                <code class="language-js">each</code>
            </a>
        </h3>
    <p>Clones the DOM node and renders a clone for each value in an array.</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:keywords each<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[.]}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>javascript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>browser<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Where there are functions declared after <code>each</code> in the attribute, they are run
on each clone.</p>
</article>

    <article class="toggle-block block" toggleable="" id="entries">
        <h3 class="text-5 ">
            <a href="#entries">
                <code class="language-js">entries</code>
            </a>
        </h3>
    <p>Maps scope to an array of <code>[key, value]</code> arrays.</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:repository entries each<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[0]}: {[1]}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>type: git<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>url: https://github.com/cruncher/sparky.git<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

    <article class="toggle-block block" toggleable="" id="fetch">
        <h3 class="text-5 ">
            <a href="#fetch">
                <code class="language-js">fetch: url</code>
            </a>
        </h3>
    <p>Fetches and parses a JSON file and uses it as scope to render the node.</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fetch:package.json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[title]}!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Sparky!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

    <article class="toggle-block block" toggleable="" id="get">
        <h3 class="text-5 ">
            <a href="#get">
                <code class="language-js">get: path</code>
            </a>
        </h3>
    <p>Maps scope to the value at <code>path</code> of the current scope:</p>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">fn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>get:repository<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{[ url ]}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{[type|capitalise]} repository<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span></code></pre>
<pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://github.com/cruncher/sparky.git<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Git repository<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span></code></pre>
</article>

    <article class="toggle-block block" toggleable="" id="stop">
        <h3 class="text-5 ">
            <a href="#stop">
                <code class="language-js">stop</code>
            </a>
        </h3>
    <p>Stops sparkifying the element. No more functions are run, and
the contents of the element are not parsed. Use <code>stop</code>
to ignore blocks of static HTML inside a Sparky template.</p>
</article>

        </div>

        <div class="x-1 xspan-3 @2-x-4 @2-xspan-6 @2-columns-2">
            <h2 class="text-3">built-in pipes.</h2>

    <article class="toggle-block block" toggleable="" id="is">
        <h3 class="text-5 ">
            <a href="#is">
                <code class="language-js">is: value</code>
            </a>
        </h3>
    <p>Returns <code>true</code> where value is strictly equal to <code>value</code>, otherwise <code>false</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="has">
        <h3 class="text-5 ">
            <a href="#has">
                <code class="language-js">has: property</code>
            </a>
        </h3>
    <p>Returns <code>true</code> where value is an object with <code>property</code>, otherwise <code>false</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="matches">
        <h3 class="text-5 ">
            <a href="#matches">
                <code class="language-js">matches: selector</code>
            </a>
        </h3>
    <p>Renders <code>true</code> if value matches <code>selector</code>. Behaviour is overloaded to accept
different types of <code>selector</code>. Where <code>selector</code> is a RegExp, value is assumed
to be a string and tested against it.</p>
<pre><code class="language-html">{[ .|matches:/abc/ ]}     // `true` if value contains 'abc'</code></pre>
<p>Where <code>selector</code> is an Object, value is assumed to be an object and its
properties are matched against those of <code>selector</code>.</p>
<pre><code class="language-html">{[ .|matches:{key: 3} ]}  // `true` if value.key is `3`.</code></pre>
</article>

    <article class="toggle-block block" toggleable="" id="class">
        <h3 class="text-5 ">
            <a href="#class">
                <code class="language-js">class</code>
            </a>
        </h3>
    <p>Renders the Class – the name of the constructor – of value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="type">
        <h3 class="text-5 ">
            <a href="#type">
                <code class="language-js">type</code>
            </a>
        </h3>
    <p>Renders <code>typeof</code> value. </p>
</article>

    <h3 class="text-4">Booleans </h3>

    <article class="toggle-block block" toggleable="" id="yesno">
        <h3 class="text-5 ">
            <a href="#yesno">
                <code class="language-js">yesno: a, b</code>
            </a>
        </h3>
    <p>Where value is truthy renders <code>a</code>, otherwise <code>b</code>. </p>
</article>

    <h3 class="text-4">Numbers </h3>

    <article class="toggle-block block" toggleable="" id="add">
        <h3 class="text-5 ">
            <a href="#add">
                <code class="language-js">add: n</code>
            </a>
        </h3>
    <p>Adds <code>n</code> to value. Behaviour is overloaded to accept various types of ‘n’.
Where <code>n</code> is a number, it is summed with value. So to add 1 to any value:</p>
<pre><code class="language-html">{[ number|add:1 ]}</code></pre>
<p>Where ‘n’ is a duration string in date-like format, value is expected to be a
date and is advanced by the duration. So to advance a date by 18 months:</p>
<pre><code class="language-html">{[ date|add:'0000-18-00' ]}</code></pre>
<p>Where ‘n’ is a duration string in time-like format, value is expected to be a
time and is advanced by the duration. So to put a time back by 1 hour and 20
seconds:</p>
<pre><code class="language-html">{[ time|add:'-01:00:20' ]}</code></pre>
</article>

    <article class="toggle-block block" toggleable="" id="floor">
        <h3 class="text-5 ">
            <a href="#floor">
                <code class="language-js">floor</code>
            </a>
        </h3>
    <p>Floors a number. </p>
</article>

    <article class="toggle-block block" toggleable="" id="root">
        <h3 class="text-5 ">
            <a href="#root">
                <code class="language-js">root: n</code>
            </a>
        </h3>
    <p>Returns the <code>n</code>th root of value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="normalise">
        <h3 class="text-5 ">
            <a href="#normalise">
                <code class="language-js">normalise: curve, min, max</code>
            </a>
        </h3>
    <p>Return a value in the nominal range <code>0-1</code> from a value between <code>min</code> and
    <code>max</code> mapped to a <code>curve</code>, which is one of <code>linear</code>, <code>quadratic</code>, <code>exponential</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="denormalise">
        <h3 class="text-5 ">
            <a href="#denormalise">
                <code class="language-js">denormalise: curve, min, max</code>
            </a>
        </h3>
    <p>Return a value in the range <code>min</code>-<code>max</code> of a value in the range <code>0</code>-<code>1</code>,
    reverse mapped to <code>curve</code>, which is one of <code>linear</code>, <code>quadratic</code>, <code>exponential</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="to-db">
        <h3 class="text-5 ">
            <a href="#to-db">
                <code class="language-js">to-db</code>
            </a>
        </h3>
    <p>Transforms values in the nominal range <code>0-1</code> to dB scale, and, when used in
    two-way binding, transforms them back a number in nominal range. </p>
</article>

    <article class="toggle-block block" toggleable="" id="to-cartesian">
        <h3 class="text-5 ">
            <a href="#to-cartesian">
                <code class="language-js">to-cartesian</code>
            </a>
        </h3>
    <p>Transforms a polar coordinate array to cartesian coordinates. </p>
</article>

    <article class="toggle-block block" toggleable="" id="to-polar">
        <h3 class="text-5 ">
            <a href="#to-polar">
                <code class="language-js">to-polar</code>
            </a>
        </h3>
    <p>Transforms a polar coordinate array to cartesian coordinates. </p>
</article>

    <article class="toggle-block block" toggleable="" id="floatformat">
        <h3 class="text-5 ">
            <a href="#floatformat">
                <code class="language-js">floatformat: n</code>
            </a>
        </h3>
    <p>Transforms numbers to strings with <code>n</code> decimal places. Used for
    two-way binding, gaurantees numbers are set on scope. </p>
</article>

    <article class="toggle-block block" toggleable="" id="floatprecision">
        <h3 class="text-5 ">
            <a href="#floatprecision">
                <code class="language-js">floatprecision: n</code>
            </a>
        </h3>
    <p>Converts number to string representing number to precision <code>n</code>. </p>
</article>

    <h3 class="text-4">Dates </h3>

    <article class="toggle-block block" toggleable="" id="add">
        <h3 class="text-5 ">
            <a href="#add">
                <code class="language-js">add: yyyy-mm-dd</code>
            </a>
        </h3>
    <p>Adds ISO formatted <code>yyyy-mm-dd</code> to a date value, returning a new date. </p>
</article>

    <article class="toggle-block block" toggleable="" id="dateformat">
        <h3 class="text-5 ">
            <a href="#dateformat">
                <code class="language-js">dateformat: yyyy-mm-dd</code>
            </a>
        </h3>
    <p>Converts an ISO date string, a number (in seconds) or a Date object
    to a string date formatted with the symbols:</p>
<pre><code><span class="token operator">-</span> <span class="token template-string"><span class="token string">`'YYYY'`</span></span> years
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'YY'`</span></span>   <span class="token number">2</span><span class="token operator">-</span>digit year
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'MM'`</span></span>   month<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">-</span>digit
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'MMM'`</span></span>  month<span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">-</span>letter
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'MMMM'`</span></span> month<span class="token punctuation">,</span> full name
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'D'`</span></span>    day <span class="token keyword">of</span> week
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'DD'`</span></span>   day <span class="token keyword">of</span> week<span class="token punctuation">,</span> two<span class="token operator">-</span>digit
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'ddd'`</span></span>  weekday<span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">-</span>letter
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'dddd'`</span></span> weekday<span class="token punctuation">,</span> full name
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'hh'`</span></span>   hours
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'mm'`</span></span>   minutes
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'ss'`</span></span>   seconds
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'sss'`</span></span>  seconds <span class="token keyword">with</span> decimals</code></pre></article>

    <h3 class="text-4">Times </h3>

    <article class="toggle-block block" toggleable="" id="add">
        <h3 class="text-5 ">
            <a href="#add">
                <code class="language-js">add: duration</code>
            </a>
        </h3>
    <p>Adds <code>duration</code>, an ISO-like time string, to a time value, and
    returns a number in seconds.</p>
<pre><code>Add <span class="token number">12</span> hours<span class="token punctuation">:</span>

<span class="token template-string"><span class="token string">``</span></span><span class="token template-string"><span class="token string">`html
{[ time|add:'12:00' ]}
`</span></span><span class="token template-string"><span class="token string">``</span></span>

Durations may be negative<span class="token punctuation">.</span> Subtract an hour and a half<span class="token punctuation">:</span>

<span class="token template-string"><span class="token string">``</span></span><span class="token template-string"><span class="token string">`html
{[ time|add:'-01:30' ]}
`</span></span><span class="token template-string"><span class="token string">``</span></span>

Numbers <span class="token keyword">in</span> a <span class="token template-string"><span class="token string">`duration`</span></span> string are not limited by the cycles <span class="token keyword">of</span> the clock<span class="token punctuation">.</span>
Add <span class="token number">212</span> seconds<span class="token punctuation">:</span>

<span class="token template-string"><span class="token string">``</span></span><span class="token template-string"><span class="token string">`html
{[ time|add:'00:00:212' ]}
`</span></span><span class="token template-string"><span class="token string">``</span></span>

Use <span class="token template-string"><span class="token string">`timeformat`</span></span> to transform the result to a readable format<span class="token punctuation">:</span>

<span class="token template-string"><span class="token string">``</span></span><span class="token template-string"><span class="token string">`html
{[ time|add:'12:00'|timeformat:'h hours, mm minutes' ]}
`</span></span><span class="token template-string"><span class="token string">``</span></span>

Not that <span class="token template-string"><span class="token string">`duration`</span></span> must be quoted because it contains <span class="token string">':'</span> characters<span class="token punctuation">.</span>
May be used <span class="token keyword">for</span> two<span class="token operator">-</span>way binding<span class="token punctuation">.</span></code></pre></article>

    <article class="toggle-block block" toggleable="" id="timeformat">
        <h3 class="text-5 ">
            <a href="#timeformat">
                <code class="language-js">timeformat: format</code>
            </a>
        </h3>
    <p>Formats value, which must be an ISO time string or a number in seconds, to
    match <code>format</code>, a string that may contain the tokens:</p>
<pre><code><span class="token operator">-</span> <span class="token template-string"><span class="token string">`'±'`</span></span>   Sign<span class="token punctuation">,</span> renders <span class="token string">'-'</span> <span class="token keyword">if</span> time is negative<span class="token punctuation">,</span> otherwise nothing
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'Y'`</span></span>   Years<span class="token punctuation">,</span> approx<span class="token punctuation">.</span>
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'M'`</span></span>   Months<span class="token punctuation">,</span> approx<span class="token punctuation">.</span>
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'MM'`</span></span>  Months<span class="token punctuation">,</span> remainder <span class="token keyword">from</span> <span class="token function">years</span> <span class="token punctuation">(</span>max <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> approx<span class="token punctuation">.</span>
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'w'`</span></span>   Weeks
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'ww'`</span></span>  Weeks<span class="token punctuation">,</span> remainder <span class="token keyword">from</span> <span class="token function">months</span> <span class="token punctuation">(</span>max <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'d'`</span></span>   Days
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'dd'`</span></span>  Days<span class="token punctuation">,</span> remainder <span class="token keyword">from</span> <span class="token function">weeks</span> <span class="token punctuation">(</span>max <span class="token number">7</span><span class="token punctuation">)</span>
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'h'`</span></span>   Hours
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'hh'`</span></span>  Hours<span class="token punctuation">,</span> remainder <span class="token keyword">from</span> <span class="token function">days</span> <span class="token punctuation">(</span>max <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">-</span>digit format
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'m'`</span></span>   Minutes
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'mm'`</span></span>  Minutes<span class="token punctuation">,</span> remainder <span class="token keyword">from</span> <span class="token function">hours</span> <span class="token punctuation">(</span>max <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">-</span>digit format
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'s'`</span></span>   Seconds
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'ss'`</span></span>  Seconds<span class="token punctuation">,</span> remainder <span class="token keyword">from</span> <span class="token function">minutes</span> <span class="token punctuation">(</span>max <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">-</span>digit format
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'sss'`</span></span> Seconds<span class="token punctuation">,</span> remainder <span class="token keyword">from</span> <span class="token function">minutes</span> <span class="token punctuation">(</span>max <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fractional
<span class="token operator">-</span> <span class="token template-string"><span class="token string">`'ms'`</span></span>  Milliseconds<span class="token punctuation">,</span> remainder <span class="token keyword">from</span> <span class="token function">seconds</span> <span class="token punctuation">(</span>max <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">-</span>digit format

<span class="token template-string"><span class="token string">``</span></span><span class="token template-string"><span class="token string">`html
{[ .|timeformat:'±hh:mm' ]}
-13:57
`</span></span><span class="token template-string"><span class="token string">``</span></span></code></pre></article>

    <h3 class="text-4">Type converters </h3>

    <article class="toggle-block block" toggleable="" id="boolean-string">
        <h3 class="text-5 ">
            <a href="#boolean-string">
                <code class="language-js">boolean-string</code>
            </a>
        </h3>
    <p>Transforms booleans to strings and vice versa. May by used for two-way binding. </p>
</article>

    <article class="toggle-block block" toggleable="" id="float-string">
        <h3 class="text-5 ">
            <a href="#float-string">
                <code class="language-js">float-string</code>
            </a>
        </h3>
    <p>Transforms numbers to float strings, and, used for two-way binding,
    gaurantees numbers are set on scope. </p>
</article>

    <article class="toggle-block block" toggleable="" id="floats-string">
        <h3 class="text-5 ">
            <a href="#floats-string">
                <code class="language-js">floats-string: separator</code>
            </a>
        </h3>
    <p>Transforms an array of numbers to a string using <code>separator</code>, and,
    used for two-way binding, gaurantees an array of numbers is set on scope. </p>
</article>

    <article class="toggle-block block" toggleable="" id="int-string">
        <h3 class="text-5 ">
            <a href="#int-string">
                <code class="language-js">int-string</code>
            </a>
        </h3>
    <p>Transforms numbers to integer strings, and, used for two-way binding,
    gaurantees integer numbers are set on scope. </p>
</article>

    <article class="toggle-block block" toggleable="" id="ints-string">
        <h3 class="text-5 ">
            <a href="#ints-string">
                <code class="language-js">ints-string: separator</code>
            </a>
        </h3>
    <p>Transforms an array of numbers to a string of integers seperated with
    <code>separator</code>, and, used for two-way binding, gaurantees an array of integer
    numbers is set on scope. </p>
</article>

    <article class="toggle-block block" toggleable="" id="string-float">
        <h3 class="text-5 ">
            <a href="#string-float">
                <code class="language-js">string-float</code>
            </a>
        </h3>
    <p>Transforms strings to numbers, and, used for two-way binding,
    gaurantees float strings are set on scope. </p>
</article>

    <article class="toggle-block block" toggleable="" id="string-int">
        <h3 class="text-5 ">
            <a href="#string-int">
                <code class="language-js">string-int</code>
            </a>
        </h3>
    <p>Transforms strings to integer numbers, and, used for two-way binding,
    gaurantees integer strings are set on scope. </p>
</article>

    <article class="toggle-block block" toggleable="" id="json">
        <h3 class="text-5 ">
            <a href="#json">
                <code class="language-js">json</code>
            </a>
        </h3>
    <p>Transforms objects to json, and used in two-way binding, sets parsed
    objects on scope. </p>
</article>

    <h3 class="text-4">Strings </h3>

    <article class="toggle-block block" toggleable="" id="append">
        <h3 class="text-5 ">
            <a href="#append">
                <code class="language-js">append: string</code>
            </a>
        </h3>
    <p>Returns value + <code>string</code>. </p>
</article>

    <article class="toggle-block block" toggleable="" id="prepend">
        <h3 class="text-5 ">
            <a href="#prepend">
                <code class="language-js">prepend: string</code>
            </a>
        </h3>
    <p>Returns <code>string</code> + value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="prepad">
        <h3 class="text-5 ">
            <a href="#prepad">
                <code class="language-js">prepad: string, n</code>
            </a>
        </h3>
    <p>Prepends value with <code>string</code> until the output is <code>n</code> characters long. </p>
</article>

    <article class="toggle-block block" toggleable="" id="postpad">
        <h3 class="text-5 ">
            <a href="#postpad">
                <code class="language-js">postpad: string, n</code>
            </a>
        </h3>
    <p>Appends value with <code>string</code> until the output is <code>n</code> characters long. </p>
</article>

    <article class="toggle-block block" toggleable="" id="slugify">
        <h3 class="text-5 ">
            <a href="#slugify">
                <code class="language-js">slugify</code>
            </a>
        </h3>
    <p>Returns the slug of value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="is-in">
        <h3 class="text-5 ">
            <a href="#is-in">
                <code class="language-js">is-in: array</code>
            </a>
        </h3>
    <p>Returns <code>true</code> if value is contained in <code>array</code>, otherwise <code>false</code>.</p>
<pre><code><span class="token template-string"><span class="token string">``</span></span><span class="token template-string"><span class="token string">`html
{[ path|is-in:[0,1] ]}
`</span></span><span class="token template-string"><span class="token string">``</span></span></code></pre></article>

    <article class="toggle-block block" toggleable="" id="localise">
        <h3 class="text-5 ">
            <a href="#localise">
                <code class="language-js">localise: n</code>
            </a>
        </h3>
    <p>Localises a number to <code>n</code> digits. </p>
</article>

    <article class="toggle-block block" toggleable="" id="lowercase">
        <h3 class="text-5 ">
            <a href="#lowercase">
                <code class="language-js">lowercase</code>
            </a>
        </h3>
    <p>Returns the lowercase string of value. </p>
</article>

    <article class="toggle-block block" toggleable="" id="pluralise">
        <h3 class="text-5 ">
            <a href="#pluralise">
                <code class="language-js">pluralise: str1, str2, lang</code>
            </a>
        </h3>
    <p>Where value is singular in a given <code>lang</code>, retuns <code>str1</code>, otherwise <code>str2</code>. </p>
</article>

        </div>
    </section>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 column-grid grid" locateable="" id="customise">
        <div class="x-1 xspan-3 @2-xspan-5">
            <h2 class="text-2">Write a function</h2>


    <h3 class="text-4">Sparky.fn</h3><p>Sparky ‘functions’ are view-controllers with access to the node where they are
declared and control over the flow of objects being sent to the renderer.</p>
<pre><code><span class="token keyword">import</span> Sparky <span class="token keyword">from</span> <span class="token string">'./sparky/build/module.js'</span><span class="token punctuation">;</span>

<span class="token comment">// Define fn="my-function:params"</span>
Sparky<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'my-function'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> node<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// input is a mappable, filterable, consumable,</span>
    <span class="token comment">// stoppable stream of scope objects</span>
    <span class="token keyword">return</span> input<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>scope<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Map scope...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Functions are called before a node is mounted. They receive a stream of scopes
and the DOM node, and may return the same stream, or a new stream, or they may
block mounting and rendering altogether. Types of return value are interpreted
as follows:</p>
<ul>
<li><code>Promise</code> - automatically converted to a stream</li>
<li><code>Stream</code> - a stream of scopes</li>
<li><code>undefined</code> - equivalent to returning the input stream</li>
<li><code>false</code> - cancels the mount process</li>
</ul>
<p>The stream returned by the last function declared in the <code>fn</code> attribute is
piped to the renderer. Values in that stream are rendered, and the life
of the renderer is controlled by the state of that stream. Sparky’s streams
come from <a href="https://stephen.band/fn/#stream">stephen.band/fn/#stream</a>.</p>



            <h3 class="text-3">Examples</h3>


    <h3 class="text-4">Examples</h3><p>Push a single scope object to the renderer:</p>
<pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> register<span class="token punctuation">,</span> Stream <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./sparky/module.js'</span><span class="token punctuation">;</span>

<span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'my-scope'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Return a stream of one object</span>
    <span class="token keyword">return</span> Stream<span class="token punctuation">.</span><span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        text<span class="token punctuation">:</span> <span class="token string">'Hello, Sparky!'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Return a promise to push a scope when it is ready:</p>
<pre><code><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'my-package'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Return a promise</span>
    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'package.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Push a new scope object to the renderer every second:</p>
<pre><code><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'my-clock'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> output <span class="token operator">=</span> Stream<span class="token punctuation">.</span><span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Push a new scope to the renderer once per second</span>
    <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        output<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            time<span class="token punctuation">:</span> window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Listen to the input stream, stop the interval</span>
    <span class="token comment">// timer when it is stopped</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Return the stream</span>
    <span class="token keyword">return</span> output<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

        </div>

        <div class="x-1 xspan-3 @2-x-6 @2-xspan-4">
            <h3 class="text-3">Function helpers</h3>


    <article class="toggle-block block" toggleable="" id="delegate-types">
        <h3 class="text-5 ">
            <a href="#delegate-types">
                <code class="function language-js"><span class="token function">delegate</span><span class="token punctuation">(</span>types<span class="token punctuation">)</span></code>
            </a>
        </h3>
    <p>Create an event delegation controller fn, where <code>types</code> is an object of objects
mapping event types and selectors to listener functions:</p>
<pre><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> delegate<span class="token punctuation">,</span> register <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./sparky/module.js'</span><span class="token punctuation">;</span>

<span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'fn-name'</span><span class="token punctuation">,</span> <span class="token function">delegate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'click'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'button'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>button<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Button was clicked...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>To further delegate by the name of the button you could use <code>get</code>
and <code>overload</code> from Fn:</p>
<pre><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> delegate<span class="token punctuation">,</span> register <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./sparky/module.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">,</span> overload <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./fn/module.js'</span><span class="token punctuation">;</span>

<span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'fn-name'</span><span class="token punctuation">,</span> <span class="token function">delegate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'click'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'button[name]'</span><span class="token punctuation">:</span> <span class="token function">overload</span><span class="token punctuation">(</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token string">'button-name'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Button name="button-name" was clicked...</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>(This is a little more efficient than listing all possible button names as
selectors).</p>
</article>

        </div>
    </section>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 column-grid grid" locateable="" id="customise">
        <div class="x-1 xspan-3 @2-xspan-5">
            <h2 class="text-2">Write a pipe</h2>


    <h3 class="text-4">Sparky.pipe</h3><p>Define a pipe using <code>Sparky.pipe(name, fn)</code>.</p>
<pre><code class="language-js"><span class="token keyword">import</span> Sparky <span class="token keyword">from</span> <span class="token string">'./sparky/build/module.js'</span><span class="token punctuation">;</span>

<span class="token comment">// Define {[.|my-pipe:param]}</span>
Sparky<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token string">'my-pipe'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// return something from param and value</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>A pipe may take any number of params; the final parameter is the
value being piped frmo the tag scope.</p>
<p>Pipes are called during the render process on the next animation frame
after the value of a tag has changed. It is best not to do anything
too expensive in a pipe to keep the render process fast.</p>


        </div>

        <div class="x-1 xspan-3 @2-x-6 @2-xspan-4">
            <h3 class="text-3">Examples</h3>


    <h3 class="text-4">Examples</h3><pre><code class="language-js"><span class="token keyword">import</span> Sparky <span class="token keyword">from</span> <span class="token string">'./sparky/build/module.js'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> tax <span class="token operator">=</span> <span class="token number">1.175</span><span class="token punctuation">;</span>

<span class="token comment">// Define {[number|add-tax]}</span>
Sparky<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token string">'add-tax'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> value <span class="token operator">*</span> tax<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>


        </div>
    </section>

    <section class="x-1 xspan-3 @1-xspan-6 @2-xspan-9 @3-x-2 columns-grid grid" locateable="" id="attributes">
        <header class="x-1 xspan-3 @1-xspan-4 block">
            <h2 class="text-2">API</h2>
        </header>

        <div class="x-1 xspan-3">

        </div>
    </section>

    <aside class="x-1 xspan-3 @2-x-2 @2-xspan-6 text-9">
        <h4 class="text-4">A note to the Django enthusiast</h4>
        <p>By now, you'll have noticed some similarities between Django and Sparky: template-led views, tags with filters and so on. Yes, Sparky was influenced by Django at <a href="https://cruncher.ch">Cruncher</a>, where we frequently write hybrid back-end/front-end templates, hence the similar syntax. They play quite nice together!</p>
    </aside>

    <!-- Build document -->


    <!-- Document interactivity -->
    <script type="module">
        import 'https://stephen.band/dom/js/device.js';
        import 'https://stephen.band/dom/js/popable.js';
        import 'https://stephen.band/dom/js/toggleable.js';
        import 'https://stephen.band/dom/js/locateable.js';
        import 'https://stephen.band/dom/js/switchable.js';
        import 'https://stephen.band/dom/js/fullscreenable.js';
        //import * as sparky from './build/module.js';
        //window = sparky;
    </script>

</body></html>